{
  "hash": "a001ab7ecf7d8ab78fab5abfa5bf5fd1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"penguin Classifier\"\nformat: \n  pdf:\n    papersize: A4\nwarning: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ntheme_set(theme_bw())\n```\n:::\n\n\n### Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 x 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# i 334 more rows\n# i 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n### Explore Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> count(species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  species       n\n  <fct>     <int>\n1 Adelie      152\n2 Chinstrap    68\n3 Gentoo      124\n```\n\n\n:::\n\n```{.r .cell-code}\npenguins |> count(island)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  island        n\n  <fct>     <int>\n1 Biscoe      168\n2 Dream       124\n3 Torgersen    52\n```\n\n\n:::\n\n```{.r .cell-code}\npenguins |>\n  ggplot(aes(flipper_length_mm,bill_length_mm,color=sex,size=body_mass_g))+\n  geom_point(alpha=0.7)+\n  facet_wrap(~species)\n```\n\n::: {.cell-output-display}\n![](penguinClassification_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_df <- penguins %>%\n  filter(!is.na(sex)) %>%\n  select(-year,-island)\npenguins_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 333 x 6\n   species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   \n   <fct>            <dbl>         <dbl>             <int>       <int> <fct> \n 1 Adelie            39.1          18.7               181        3750 male  \n 2 Adelie            39.5          17.4               186        3800 female\n 3 Adelie            40.3          18                 195        3250 female\n 4 Adelie            36.7          19.3               193        3450 female\n 5 Adelie            39.3          20.6               190        3650 male  \n 6 Adelie            38.9          17.8               181        3625 female\n 7 Adelie            39.2          19.6               195        4675 male  \n 8 Adelie            41.1          17.6               182        3200 female\n 9 Adelie            38.6          21.2               191        3800 male  \n10 Adelie            34.6          21.1               198        4400 male  \n# i 323 more rows\n```\n\n\n:::\n:::\n\n\n## Build a model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidymodels)\n\nset.seed(123)\npenguin_split <- initial_split(penguins_df,strata=sex)\npenguin_train <- training(penguin_split)\npenguin_test <- testing(penguin_split)\n\nset.seed(234)\npenguin_boot <- bootstraps(penguin_train)\npenguin_boot\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Bootstrap sampling \n# A tibble: 25 x 2\n   splits           id         \n   <list>           <chr>      \n 1 <split [249/92]> Bootstrap01\n 2 <split [249/99]> Bootstrap02\n 3 <split [249/94]> Bootstrap03\n 4 <split [249/97]> Bootstrap04\n 5 <split [249/93]> Bootstrap05\n 6 <split [249/90]> Bootstrap06\n 7 <split [249/86]> Bootstrap07\n 8 <split [249/92]> Bootstrap08\n 9 <split [249/90]> Bootstrap09\n10 <split [249/89]> Bootstrap10\n# i 15 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglm_spec <- logistic_reg()%>%\n  set_engine(\"glm\") \n\nrf_spec <- rand_forest() %>%\n  set_mode(\"classification\") %>%\n  set_engine(\"ranger\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npenguin_wf <- workflow() %>%\n  add_formula(sex ~ .)\n\npenguin_wf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n== Workflow ====================================================================\nPreprocessor: Formula\nModel: None\n\n-- Preprocessor ----------------------------------------------------------------\nsex ~ .\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglm_rs <- penguin_wf %>%\n  add_model(glm_spec) %>%\n  fit_resamples(\n    resamples = penguin_boot,\n    control=control_resamples(save_pred=TRUE, verbose=TRUE)\n  )\n\nrf_rs <- penguin_wf %>%\n  add_model(rf_spec) %>%\n  fit_resamples(\n    resamples=penguin_boot,\n    control=control_resamples(save_pred=TRUE,verbose=TRUE)\n  )\n```\n:::\n\n\n### Evaluate modeling\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollect_metrics(rf_rs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 6\n  .metric     .estimator   mean     n std_err .config             \n  <chr>       <chr>       <dbl> <int>   <dbl> <chr>               \n1 accuracy    binary     0.925     25 0.00467 Preprocessor1_Model1\n2 brier_class binary     0.0604    25 0.00222 Preprocessor1_Model1\n3 roc_auc     binary     0.980     25 0.00188 Preprocessor1_Model1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncollect_metrics(glm_rs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 6\n  .metric     .estimator   mean     n std_err .config             \n  <chr>       <chr>       <dbl> <int>   <dbl> <chr>               \n1 accuracy    binary     0.917     25 0.00481 Preprocessor1_Model1\n2 brier_class binary     0.0603    25 0.00388 Preprocessor1_Model1\n3 roc_auc     binary     0.977     25 0.00471 Preprocessor1_Model1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglm_rs %>%\n  conf_mat_resampled()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 3\n  Prediction Truth   Freq\n  <fct>      <fct>  <dbl>\n1 female     female 40.8 \n2 female     male    3.8 \n3 male       female  3.76\n4 male       male   43.1 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglm_rs %>%\n  collect_predictions() %>%\n  group_by(id) %>%\n  roc_curve(sex, .pred_female)%>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](penguinClassification_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n",
    "supporting": [
      "penguinClassification_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}