{
  "hash": "f965574589605376d66380225229c93c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"diabetes\"\nformat: html\nwarning: FALSE\nnumber-sections: true\n---\n\n\n## Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# the diabetes.csv file is put here together with the R file.\nlibrary(rrcov)\ndata(diabetes)\nhead(diabetes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    rw fpg glucose insulin sspg  group\n1 0.81  80     356     124   55 normal\n2 0.95  97     289     117   76 normal\n3 0.94 105     319     143  105 normal\n4 1.04  90     356     199  108 normal\n5 1.00  90     323     240  143 normal\n6 0.76  86     381     157  165 normal\n```\n\n\n:::\n:::\n\n\n## Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"reshape2\")\n ggplot( melt(diabetes, id.vars = \"group\"), \n         aes(x = value, col = group)) +\n geom_density() + \n facet_wrap( ~variable, ncol = 2, scales = \"free\") +\n theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](diabetes_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Linear Discrimination\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdb = ggplot(diabetes, aes(x = sspg, y = glucose)) +\n  geom_point(aes(colour = group))\nggdb\n```\n\n::: {.cell-output-display}\n![](diabetes_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\ndiabetes_lda <- lda(group ~ sspg + glucose, data=diabetes)\ndiabetes_lda\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nlda(group ~ sspg + glucose, data = diabetes)\n\nPrior probabilities of groups:\n   normal  chemical     overt \n0.5241379 0.2482759 0.2275862 \n\nGroup means:\n             sspg   glucose\nnormal   114.0000  349.9737\nchemical 208.9722  493.9444\novert    318.8788 1043.7576\n\nCoefficients of linear discriminants:\n                LD1         LD2\nsspg    0.005036943 -0.01539281\nglucose 0.005461400  0.00449050\n\nProportion of trace:\n   LD1    LD2 \n0.9683 0.0317 \n```\n\n\n:::\n:::\n\n\n## Prediction\n\n\n::: {.cell}\n\n```{.r .cell-code}\nghat <- predict(diabetes_lda)$class\ntable(ghat, diabetes$group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          \nghat       normal chemical overt\n  normal       69       12     1\n  chemical      7       24     6\n  overt         0        0    26\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(ghat != diabetes$group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1793103\n```\n\n\n:::\n:::\n\n\n## Visualise LDA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmake1Dgrid = function(x) {\n  rg = grDevices::extendrange(x)\n  seq(from = rg[1], to = rg[2], length.out = 100)\n}\ndiabetes_grid = with(diabetes,\n  expand.grid(sspg = make1Dgrid(sspg),\n              glucose = make1Dgrid(glucose)))\n\ndiabetes_grid$ghat =\n  predict(diabetes_lda, newdata = diabetes_grid)$class\n\ncenters = diabetes_lda$means\n\nunitcircle = exp(1i * seq(0, 2*pi, length.out = 360)) |>\n          (\\(z) cbind(Re(z), Im(z)))() \nellipse = unitcircle %*% solve(diabetes_lda$scaling) |> as_tibble()\n\nlibrary(\"dplyr\")\nellipses = lapply(rownames(centers), function(gr) {\n  mutate(ellipse,\n     sspg    = sspg    + centers[gr, \"sspg\"],\n     glucose = glucose + centers[gr, \"glucose\"],\n     group   = gr)\n}) |> bind_rows()\n\nggdb + geom_raster(aes(fill = ghat),\n            data = diabetes_grid, alpha = 0.25, interpolate = TRUE) +\n    geom_point(data = as_tibble(centers), pch = \"+\", size = 8) +\n    geom_path(aes(colour = group), data = ellipses) +\n    scale_x_continuous(expand = c(0, 0)) +\n    scale_y_continuous(expand = c(0, 0))\n```\n\n::: {.cell-output-display}\n![](diabetes_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "diabetes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}